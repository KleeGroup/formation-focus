<!doctype html>
<html lang="fr">

<head>
	<title>Formation focus2</title>

	<meta name="description" content="Une formation sur Focus2">
	<meta name="author" content="Kleegroup">

	<meta name="apple-mobile-web-app-capable" content="yes">
	<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

	<link rel="stylesheet" href="css/reveal.css">
	<link rel="stylesheet" href="css/theme/black.css" id="theme">

	<!-- Code syntax highlighting -->
	<link rel="stylesheet" href="lib/css/zenburn.css">

	<!-- Printing and PDF exports -->
	<script>
		var link = document.createElement( 'link' );
		link.rel = 'stylesheet';
		link.type = 'text/css';
		link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
		document.getElementsByTagName( 'head' )[0].appendChild( link );
	</script>

	<!--[if lt IE 9]>
	<script src="lib/js/html5shiv.js"></script>
	<![endif]-->
	<link href='https://fonts.googleapis.com/css?family=Merriweather:700|Source+Sans+Pro:300,600,300italic,600italic|Source+Code+Pro:400,600' rel='stylesheet' type='text/css'>

	<style>
		.redTransparent{
			background-color: rgba(255, 0, 0, 0.5);
		}
		.blackTransparent{
			background-color: rgba(0, 0, 0, 0.5);
			padding: 12px !important;
		}
		html .reveal {
			font-size: 34px;
		}
		.reveal strong, .reveal b {
			color: #cc9393;
		}
	</style>
</head>

<body>

	<div class="reveal">
		<div class="slides">

			<!-- Section générale sur focus -->
			<section>
				<section>
					<h2>Focus</h2>
					<p>
						<a href='http://get-focus.github.io/formation-focus/#/'>http://get-focus.github.io/formation-focus</a>
					</p>
				</section>

				<section>
					<h2>Pourquoi Focus?</h2>
				</section>

				<section data-background='https://i.ytimg.com/vi/M_WUvsFY9-4/maxresdefault.jpg'>
					<h2 class='blackTransparent'>Klee fait des applications sur mesure</h2>
				</section>

				<section ><h2>Les missions de Focus</h2></section>
				
				<section data-background='http://usabilitygeek.com/wp-content/uploads/2011/07/usability-user-experience-difference.jpg'>
					<h2 class='blackTransparent'>Remettre l'humain au centre UX</h2>
				</section>

				<section data-background='https://media.giphy.com/media/W4ZYPB4q4DSbS/giphy.gif'>
					<h2 class='blackTransparent'>Developer Experience DX</h2>
				</section>

				<section data-background='http://keithrhiggons.com/wp-content/uploads/2014/09/CHANGES.jpg'>
					<h2 class='redTransparent'>Capter et digérer l'innovation</h2>
				</section>
				
				<section>
					<h2>Objectifs</h2>
				</section>

				<section>
					<h3>Faire rapidement et facilement 80% des écrans de l'application</h3>
					<ul>
						<li>Respecter les maquettes</li>
						<li>Composants UX prêt à l'emploi</li>
					</ul>
				</section>

				<section>
					<h3>Faire facilement du sur mesure 20% des écrans de l'application</h3>
					<ul>
						<li>Utilisation de React & Flux</li>
					</ul>
				</section>

				<section data-background='https://cdnfr1.img.sputniknews.com/images/103359/83/1033598316.jpg'>
					<h2 class='blackTransparent'>Le bureau Focus</h2>
				</section>
				
				<section data-background='http://www.cosatto.com/blog/wp-content/uploads/2011/08/babyshow_smaller.jpg'>
					<ul class='blackTransparent'>
						<li>Validation de choix avant de se lancer ?</li>
						<li>Validation des maquettes</li>
						<li>Conception technique d'écran</li>
						<li>Pour partager vos bonnes idées</li>
					</ul>
				</section>

				<section data-background='http://www.quizz.biz/uploads/quizz/888745/1_98CBQ.jpg'>
					<h2 class='blackTransparent'>Je n'arrive pas à faire rentrer mon écran dans le pattern</h2>
					<ul></ul>
				</section>

				<section data-background='http://regmedia.co.uk/2012/04/02/word_2_doc.png'>
					<h2 class='blackTransparent'>Mon client veut un écran un peu funky</h2>

				</section>

				<section data-background='http://www.xanetiz.com/images/articles/bugs-connus-histoire1.png'>
					<h2 class='blackTransparent'>Je trouve un bug sur Focus</h2>
				</section>

				<section>
					<h2>Des suggestions ou problèmes:</h2>
					<ul>
						<li>focus@kleegroup.com</li>
						<li><a href='http://community-focus.slack.com/'>community-focus #slack</a></li>
					</ul>
				</section>
			</section>


			<!-- Section github & eco-système -->
			<section>
				<section data-background='https://assets-cdn.github.com/images/modules/open_graph/github-octocat.png'>
					<h2 class='blackTransparent'>github</h2>
				</section>

				<section>
					<h2><a href='https://getfocus.io'>GetFocus.io</a></h2>
				</section>

				<section>
					<h2>Les librairies coeur</h2>
					<h2><a href="https://github.com/KleeGroup/focus-core">Focus Core</a></h2>
					<h2><a href="https://github.com/KleeGroup/focus-components">Focus Components</a></h2>
				</section>

				<section>
					<h2>Les extensions</h2>
					<h2><a href="https://github.com/KleeGroup/focus-file">Focus file</a></h2>
					<h2><a href="https://github.com/KleeGroup/focus-notification">Focus Notification</a></h2>
					<h2><a href="https://github.com/KleeGroup/focus-comments">Focus Comments</a></h2>
				</section>

				<section>
					<h2>Documentation</h2>
					<h2><a href="https://github.com/KleeGroup/focus-showcase">Focus Showcase</a></h2>
					<h2><a href="https://github.com/KleeGroup/focus-docs">Focus docs</a></h2>
					<h2><a href="https://github.com/KleeGroup/focus-demo">Focus demo</a></h2>
				</section>

				<section>
					<h2>Outils</h2>
					<h2><a href="https://github.com/KleeGroup/eslint-config-focus">Focus eslint</a></h2>
					<h2><a href="https://github.com/KleeGroup/webpack-focus">Focus webpack</a></h2>
				</section>

				<section>
					<h2><a href='http://kleegroup.github.io/focus-docs/contribute/index.html'>Contribuez à Focus</a></h2>
					<p>issues, PR, doc, articles, tuto, DX, ...</p>
				</section>
			</section>

			<!-- Section flux-->
			<section>
				<section>
					<h2>Flux</h2>
					<p><a href="https://github.com/facebook/flux">Flux's github</a></p>
				</section>

				<section>
					<h2>Histoire</h2>
					<p>
						Il était une fois un gros site web que s'apelait Facebook. Qui dit Facebook, 
						dit webapp plus grosse que la plus grosse de tes copines (no offense); 
						et du coup, propension à se retrouver submergé de bugs plus élevée.
					</p>
					<p>
						Les ingénieurs front-end de Facebook, confrontés à une codebase de plus en 
						plus bordélique (personne ne voulant toucher certaines parties de celle-ci) 
						ont dû repenser la structure des composants les plus cruciaux.
					</p>
				</section>

				<section>
					<h2>4 concepts</h2>
					<ul>
						<li>les <u>actions</u>, proviennent du serveur ou d'une interaction user;</li>
						<li>le <u>dispatcher</u> reçoit les actions et transmet à qui veut, un peu comme un EventEmitter global;</li>
						<li>les <u>stores</u>, équivalent du model de l'architecture MVC, ils contiennent les données, réagissent aux actions que le dispatcher leur transmet;</li>
						<li>les <u>views</u>, qui s'occupent du rendu des données dans le DOM, et de lancer des actions lorsque l'utilisateur effectue certaines actions.</li>
					</ul>
				</section>

				<section>
					<h2>En image</h2>
					<img src="./images/flux_concepts.png" alt="flux">
				</section>

				<section data-background="./images/twitter.gif">
					<h2 class="blackTransparent">Synchronisation des photos</h2>
				</section>

				<section data-markdown>
					## Action - Simple
					
					On définit une action avec un __action creator__
					
					```javascript
					import { appDispatcher } from "../dispatcher";
					import { actionTypes } from "../constants";

					// Actions du basket
					export const basketActions = {
						// Action creator : addToBasket
						addToBasket(productId) {
							// Dispatch l'action au travers du dispatcher
							appDispatcher.handleViewAction({
								// Type de l'action
								type: actionTypes.ADD_TO_BASKET,
								// Payload de l'action
								productId: productId,
							});
						},
					};
					```
				</section>

				<section data-markdown>
					## Action - Complexe
					
					Ici l'action va appeler une API sur le backend et dispatch le résultat
					
					```javascript
					import { appDispatcher } from "../dispatcher";
					import { actionTypes } from "../constants";
					import { basketService } from "../services";

					// Actions du basket
					export const basketActions = {
						// Action creator : orderBasket
						orderBasket() {
							// Appel du service
							basketService.orderBasket().then(orderStatus => {
								// Dispatch du resultat du service
								appDispatcher.handleServerAction({
									type: actionTypes.ORDER_BASKET,
									orderStatus: orderStatus,
								});
							})
						},
					};
					```
				</section>

				<section data-markdown>
					## Service
					
					```javascript
					import basketApis from '../apis';
					
					// Basket service
					export basketService {
						orderBasket() {
							return basketApis.oderBasket();
						},
						addToBacket(productId) {
							return basketApis.addToBasket({}, { productId })
						}
						// Api méthode signature : (urlParams, bodyParam, options)
					}
					```

					- 80% sont un passe plat vers une API
					- 20% peuvent réaliser des actions complexes
				</section>
	
				<section data-markdown>
					## View - dispatch d'une action
					
					On émet une action lors d'une action utilisateur
					
					```javascript
					import { React } from "react";
					import { basketActions } from "../actions";
					import { Button } from "../components";

					export const Product = ({ productId }) => (
						&lt;div class="product"&gt;
							{/* Component stuff */}
							&lt;button&gt;
								{/* Appel de l'action creator */}
								onClick={() => basketActions.addToBasket(productId)}
								label="Ajouter au panier"
							&lt;/button&gt;
						&lt;/div&gt;
					);
					```
					
					A chaque clic sur le bouton, l'action ADD_TO_BASKET est passée au dispatcher
				</section>

				<section data-markdown>
					## Store
					
					Le __store__ s'enregistre auprès du __dispatcher__. Il verra donc toutes les __actions__. 
					C'est au __store__ de savoir si il doit traiter ou non l'__action__

					```javascript
					import { appDispatcher } from "../dispatcher";
					import { actionTypes } from "../constants";

					// Etat initial du store et fonction de mise à jour
					export const basketStore = createStore({ products: [] }, action => {
						const { type } = action;
						
						switch (action) {
							case actionTypes.ADD_TO_BASKET:
								const { productId } = action;
								// Ajoute le productId à la collection
								this.products = [...this.products, productId];
								break;
							// [...] Autres actions
						}
					});

					appDispatcher.register(basketStore.dispatcherCallback);
					```
				</section>

				<section data-markdown>
					## View - Ecoute d'un store
					```javascript
					import { React } from "react";
					import { basketStore } from "../stores";

					export const Basket = React.createClass({
						// State initial du composant
						getInitialState() { return { products: basketStore.products }; },
						// Fonction appellée au changement de données dans le store
						_onStoreChange() { this.setState({ products: basketStore.products }); },
						// Le composant s'enregistre auprès du store pour recevoir les modifications
						componentDidMount() { basketStore.addChangeListner(this._onStoreChange); },
						// Le composant annule sa souscription auprès du store
						componentWilltUnmount() { basketStore.removeChangeListener(this._onStoreChange); },
						render() {
							&lt;div class="basket"&gt;
								{`${this.state.products.length} products`} 
							&lt;/div&gt;
						}
					});
					```
				</section>
				
				<section>
					<h2>Flux - Phase d'enregistrement</h2>
					<img src="./images/focus-flux1.PNG" alt="flux1">
				</section>
	
				<section>
					<h2>flux - Phase de dispatch</h2>
					<img src="./images/focus-flux2.PNG" alt="flux2">
				</section>
	
				<section>
					<h2>TL;DR</h2>
					<ul>
						<li>L'architecture est unidirectionnelle</li>
						<li>On raisonne en actions, qui sont déclendhées par la vue ou le serveur</li>
						<li>Toutes les actions passent par le dispatcher</li>
						<li>Seuls les stores signalent aux vues qu'il faut se mettre à jour</li>
					</ul>
				</section>
			</section>


			<!-- Section Focus -->
			<section data-background='https://media.giphy.com/media/Sq4QZyBwagvle/giphy.gif'><h2>Focus2.js</h2></section>


			<!-- Architecture d'application -->
			<section>

				<section>
					<h2>Architecture d'une app Focus2</h2>
					<img src="./images/archi.png" alt="archi">
				</section>

				<section>
					<h2>Service</h2>
					<ul>
						<li>Un service est une fonction</li>
						<li>
							Un service appelle une url construite grâce à 
							<a href="https://github.com/KleeGroup/focus-core/blob/develop/src/list/action-builder.js">urlbuilder</a>
						</li>
						<li>Un service retourne une <u>Promise</u></li>
						<li>
							On peut utiliser la méthode <u>fetch</u> de 
							<a href="https://github.com/KleeGroup/focus-core/blob/develop/src/network/fetch.js">focus</a>
						</li>
					</ul>
				</section>

				<section>
					<h2>store</h2>
					<ul>
						<li>Un store est un objet qui contient une grappe de données</li>
						<li>
							Associé à une notion de grappe d'objet
							(<a href="https://github.com/KleeGroup/focus-core/blob/develop/src/store/CoreStore.js">corestore</a>)
						</li>
						<li>
							Il existe des stores spécialisées 
							(<a href="https://github.com/KleeGroup/focus-core/tree/develop/src/store/search">recherche</a>,
							<a href="https://github.com/KleeGroup/focus-core/tree/develop/src/store/search">liste</a>)
						</li>
						<li>Il peut notifier: d'un changement, d'une erreur</li>
						<li>Chaque noeud de données peut avoir un statut</li>
					</ul>
				</section>
				
				<section>
					<h2>Exemple de store</h2>
					<section data-markdown>
						```javascript
						import {CoreStore} from 'focus-core/store';
						const movieStore = new CoreStore({
							definition: {
								movie: 'movie',
								actors: 'actors'
							}
						});

						export default movieStore;
						```
					</section>
				</section>
				
				<section>
					<h2>action</h2>
					<ul>
						<li>Une action est une fonction</li>
						<li>Une action doit appeller un service</li>
						<li>Avec le retour (après l'appel serveur)</li>
						<li>Dispatch le résultat dans le <u>dispatcher</u></li>
						<li>
							On peut utiliser le <u>actionBuilder</u>
							(<a href="https://github.com/KleeGroup/focus-core/blob/develop/src/application/action-builder.js">detail</a>,
							<a href="https://github.com/KleeGroup/focus-core/blob/develop/src/search/action-builder.js">recherche</a>,
							<a href="https://github.com/KleeGroup/focus-core/blob/develop/src/list/action-builder.js">liste</a>)
						</li>
					</ul>
				</section>
				
				<section>
					<h2>Exemple d'action</h2>
					<section data-markdown>
						```javascript
						import actionBuilder from 'focus-core/application/action-builder';
						import {loadMovie, saveMovieSynopsis} from '../services/movie';

						export const synopsisActions = {
							load: actionBuilder({
								node: 'movie',
								service: loadMovie,
								shouldDumpStoreOnActionCall: true,
								status: 'loaded'
							}),
							save: actionBuilder({
								node: 'movie',
								service: saveMovieSynopsis,
								shouldDumpStoreOnActionCall: true,
								status: 'saved'
							})
						}
						```
					</section>
				</section>

				<section data-background='http://auto.mgl.skyrock.net/art/SHAR.8448.337.2.jpg'>
					<h2>Un exemple de composant mis en musique</h2>
					<section data-markdown>
						```javascript
						//librairies
						import React, {PropTypes} from 'react';
						import FocusComponents from 'focus-components';

						// web components
						import Panel from 'focus-components/components/panel';
						import {mixin as formMixin} from 'focus-components/common/form';

						//stores & actions
						import movieStore from '../../../stores/movie';
						import {caracteristicsActions} from '../../../action/movie';

						export default React.createClass({
							displayName: 'MovieCaracteristics',
							propTypes: {
								id: PropTypes.number
							},
							mixins: [formMixin],
							definitionPath: 'movie',
							stores: [{store: movieStore, properties: ['movie']}],
							action: caracteristicsActions,

							/** @inheritDoc */
							renderContent() {
								return (
									&lt;Panel actions={this._renderActions} title='movie.detail.caracteristics'&gt;
										{this.fieldFor('title')}
										{this.fieldFor('originalTitle')}
										{this.fieldFor('keywords')}
										{this.fieldFor('runtime')}
										{this.fieldFor('movieType')}
										{this.fieldFor('productionYear')}
										{this.fieldFor('trailerName')}
										{this.fieldFor('trailerHRef')}
									&lt;/Panel&gt;
								);
							}
						});
						```
					</section>
				</section>
			</section>

			<!-- Section Routing -->
			<section>
				<section>
					<h2>Le router de l'application</h2>
				</section>
				
				<section>
					<h2><a href="https://github.com/reactjs/react-router">Router</a></h2>
					<img src="https://cloud.githubusercontent.com/assets/286966/15237848/4daec5de-18d2-11e6-8b77-b5e3387014c9.png" alt="router">
				</section>
				
				<section>
					<h2>Et voici l'exemple</h2>
				
					<section data-markdown>
						```javascript
						import React from 'react';
						import { Route, IndexRoute } from 'react-router';
						import AppLayout from '../components/layout'
						import HomeRoute from './home-route';
						import MasterdataRoutes from './masterdata-routes';
						import MoviesRoutes from './movies-route';
						import PersonsRoutes from './persons-route';
						import SearchRoutes from './advanced-search-route';
						import ErrorRoutes from './error-route';

						export default {
							path: `${__BASE_URL__}`,
							indexRoute: { onEnter: ({ params }, replace) => replace(`${__BASE_URL__}home`) },
							component: AppLayout,
							childRoutes: [...HomeRoute, ...MasterdataRoutes, ...MoviesRoutes, ...PersonsRoutes, ...SearchRoutes, ...ErrorRoutes]
						};

						import React from 'react';
						import MovieDetailView from '../views/movie/detail';

						const route = [
							{
								path: 'movies/:id',
								component: (props) => (&lt;MovieDetailView id={parseInt(props.params.id)} {...props}/&gt;)
							}
						];

						export default route;
						```
					</section>
				</section>
			</section>


			<!-- Section domaine & definition -->
			<section>
				<section>
					<h2>Les domaines et les définitions</h2>
				</section>
				
				<section>
					<h2>les domaines</h2>
					<ul>
						<li>Responsable de la validation</li>
						<li>Du composant de rendu (consultation, édition)</li>
						<li>formatage  des données</li>
						<li>On peut les utiliser pour le style</li>
						<li>Utilisation intelligente avec `fieldFor`</li>
					</ul>
				</section>
				
				<section>
					<h2>example du domaine do-date.js</h2>
					<section data-markdown>
						```javascript
						import moment from 'moment';
						import {Date as DateComponent} from 'focus-components/components/input';

						export default {
							InputComponent: DateComponent,
							formatter: date => date ? moment(date, moment.ISO_8601).format('DD/MM/YYYY') : '',
							format: ['DD/MM/YYYY', 'DD-MM-YYYY', 'D MMM YYYY']
						};
						```
					</section>
				</section>

				<section>
					<h2>Les définitions</h2>
					<ul>
						<li>Générées depuis le modèle de données</li>
						<li>Lie le modèle de données aux domaines</li>
						<li>Chaque table a des champs</li>
						<li>Chaque champ a un domaine</li>
						<li>Chaque champ porte l'information requis / non requis</li>
					</ul>
				</section>

				<section>
					<h2>example de définitions</h2>
					<section data-markdown>
						```javascript
						export const movie = {
							code: {
								domain: 'DO_ID',
								required: true
							},
							title: {
								domain: 'DO_LABEL_LONG',
								required: true
							},
							creationDate: {
								domain: 'DO_DATE',
								required: false
							}
						}
	
						// fieldFor(creationDate)
						```
					</section>
				</section>
			</section>
			
			<section data-markdown>
				## tutos
				- [Faire une page de détail](http://kleegroup.github.io/focus-docs/tutorial/detail.html)
				- [Faire une page de liste](http://kleegroup.github.io/focus-docs/tutorial/list.html)
			</section>		
			

			<section data-markdown>
				## Structure applicative

				- [Focus docs](http://kleegroup.github.io/focus-docs/getting-started/starter-kit.html)
				- [Focus demo app](https://github.com/KleeGroup/focus-demo-app)
			</section>
			

			<section data-background='https://mtpmcg.files.wordpress.com/2014/07/thanks-b-fr-mtpmcg714-sm-2163.jpg'></section>
		</div>
	</div>

	<script src="lib/js/head.min.js"></script>
	<script src="js/reveal.js"></script>
	<script>
		// More info about config & dependencies:
		// - https://github.com/hakimel/reveal.js#configuration
		// - https://github.com/hakimel/reveal.js#dependencies
		Reveal.initialize({
			history: true,
			dependencies: [
				{ src: 'plugin/markdown/marked.js' },
				{ src: 'plugin/markdown/markdown.js' },
				{ src: 'plugin/notes/notes.js', async: true },
				{ src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } }
			]
		});
	</script>
</body>
</html>
